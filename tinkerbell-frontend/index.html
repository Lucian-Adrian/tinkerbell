<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tinkerbell - AI marketing assistant</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // Debug logging
        console.log('Index.html loading...');
        console.log('Session storage fromLanding:', sessionStorage.getItem('fromLanding'));
        console.log('URL search:', window.location.search);
        console.log('URL includes app:', window.location.search.includes('app'));

        // Check if user came from landing page or redirect to landing page
        if (!sessionStorage.getItem('fromLanding') && !window.location.search.includes('app')) {
            console.log('Redirecting to landing page...');
            window.location.href = 'landing.html';
        } else {
            console.log('Showing main app...');
        }
    </script>
</head>

<body>
    <!-- Header Navigation -->
    <header class="app-header">
        <div class="container">
            <div class="brand">
                <img src="tinkerbell-logo.png" alt="Tinkerbell" class="logo">
            </div>
        </div>
    </header>

    <!-- Page 1: Business Setup -->
    <div id="page-onboarding" class="page active">
        <div class="container">
            <div class="onboarding-wrapper">
                <div class="onboarding-content">
                    <div class="step-indicator">
                        <span class="step active">1</span>
                        <span class="step">2</span>
                        <span class="step">3</span>
                    </div>

                    <div class="page-header">
                        <h2>Tell us about your business</h2>
                        <p>We'll use this information to create personalized marketing campaigns that work for your specific audience.</p>
                    </div>

                    <form id="onboarding-form" class="onboarding-form">
                        <div class="form-section">
                            <div class="form-group">
                                <label for="businessName">Business name</label>
                                <input type="text" id="businessName" name="businessName" placeholder="e.g., Martha's Flower Shop" required>
                            </div>

                            <div class="form-group">
                                <label for="businessDescription">What does your business do?</label>
                                <textarea id="businessDescription" name="businessDescription" placeholder="e.g., Local florist in Chisinau specializing in unique wedding arrangements and special event flowers" required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="targetCustomers">Who are your ideal customers?</label>
                                <textarea id="targetCustomers" name="targetCustomers" placeholder="e.g., Brides-to-be, event planners, people looking for special gifts"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="businessGoals">What are your main business goals?</label>
                                <textarea id="businessGoals" name="businessGoals" placeholder="e.g., Attract more clients for large events, increase online visibility"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="websiteUrl">Website or Facebook page <span class="optional">(optional)</span></label>
                                <input type="url" id="websiteUrl" name="websiteUrl" placeholder="https://www.facebook.com/marthasflowers">
                                <small>We'll analyze your content to better understand your business</small>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                Continue
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Page 2: Customer Personas -->
    <div id="page-personas" class="page">
        <div class="container">
            <div class="personas-wrapper">
                <div class="step-indicator">
                    <span class="step completed">1</span>
                    <span class="step active">2</span>
                    <span class="step">3</span>
                </div>

                <div class="page-header">
                    <h2>Review your customer personas</h2>
                    <p>We've created detailed profiles of your ideal customers. You can edit them if something doesn't look right.</p>
                </div>

                <div id="loading-log" class="loading-section">
                    <div class="loading-content">
                        <div class="loading-spinner"></div>
                        <h3>Creating your marketing strategy...</h3>
                        <div class="progress-log">
                            <div class="log-item completed">
                                <span class="checkmark">✓</span>
                                <span>Analyzing your business context...</span>
                            </div>
                            <div class="log-item completed">
                                <span class="checkmark">✓</span>
                                <span>Identifying target audience and creating personas...</span>
                            </div>
                            <div class="log-item completed">
                                <span class="checkmark">✓</span>
                                <span>Generating personalized campaign ideas...</span>
                            </div>
                            <div class="log-item completed">
                                <span class="checkmark">✓</span>
                                <span>Creating AI-powered posts and ads...</span>
                            </div>
                            <div class="log-item completed">
                                <span class="checkmark">✓</span>
                                <span>Evaluating lead potential...</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="personas-editor" class="personas-section">
                    <div id="personas-container">
                        <!-- Personas will be populated by JavaScript -->
                    </div>

                    <!-- Image Upload Section -->
                    <div class="media-upload-section">
                        <h3>Add campaign images</h3>
                        <p>Upload images you'd like to use in your posts, or let our AI generate new ones for you.</p>

                        <div class="upload-area" id="upload-area">
                            <div class="upload-content">
                                <div class="upload-icon">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                                    </svg>
                                </div>
                                <h4>Drag and drop images here</h4>
                                <p>or <span class="upload-link">click to browse</span></p>
                                <small>JPG, PNG, GIF up to 10MB per image</small>
                            </div>
                            <input type="file" id="image-upload" multiple accept="image/*" style="display: none;">
                        </div>

                        <div id="uploaded-images-preview" class="uploaded-images">
                            <!-- Uploaded images will be shown here -->
                        </div>

                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="generate-missing-images" checked>
                                <span class="checkmark"></span>
                                <span>Generate images automatically for posts without visuals</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button id="confirm-personas" class="btn btn-primary">
                            Continue to campaigns
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Page 3: Campaign Dashboard -->
    <div id="page-campaign" class="page">
        <div class="container">
            <div class="campaign-wrapper">
                <div class="step-indicator">
                    <span class="step completed">1</span>
                    <span class="step completed">2</span>
                    <span class="step active">3</span>
                </div>

                <div class="page-header">
                    <h2>Your marketing campaigns</h2>
                    <p>Here's your AI-generated marketing strategy and social media posts ready to launch.</p>
                </div>

                <div class="campaign-content">
                    <div id="strategy-section" class="strategy-card">
                        <h3>Marketing strategy</h3>
                        <div id="marketing-strategy" class="strategy-content">
                            <div class="loading-placeholder">Loading strategy...</div>
                        </div>
                    </div>

                    <div id="posts-section" class="posts-section">
                        <div class="section-header">
                            <h3>Social media posts</h3>
                            <span class="post-count" id="posts-count">0 posts ready</span>
                        </div>
                        <div id="posts-container" class="posts-grid">
                            <!-- Posts will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Image Processing Results Section -->
                    <div id="image-processing-results" class="results-section" style="display: none;">
                        <!-- Will be populated by JavaScript -->
                    </div>

                    <!-- Auto-Posting Status Section -->
                    <div id="auto-posting-status" class="status-section" style="display: none;">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <div class="campaign-metrics">
                        <div class="metrics-grid">
                            <div class="metric-card">
                                <div class="metric-label">Suggested budget</div>
                                <div class="metric-value">$20</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">Estimated qualified leads</div>
                                <div class="metric-value">5-8</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">Estimated cost per lead</div>
                                <div class="metric-value">$0.95-2.45</div>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button id="schedule-campaign" class="btn btn-primary btn-large">
                            Launch campaigns
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Page 4: Success -->
    <div id="page-success" class="page">
        <div class="container">
            <div class="success-wrapper">
                <div class="success-content">
                    <div class="success-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                            <polyline points="22,4 12,14.01 9,11.01"/>
                        </svg>
                    </div>

                    <div class="success-header">
                        <h2>Campaign created successfully!</h2>
                        <p>Your marketing campaigns have been created and scheduled in Planable.</p>
                    </div>

                    <div class="success-details">
                        <div class="detail-card">
                            <h3>What happened:</h3>
                            <ul id="success-details">
                                <li>Workspace created in Planable</li>
                                <li><span id="posts-count">3</span> posts scheduled</li>
                                <li>Campaign ready to launch</li>
                            </ul>
                        </div>

                        <div class="workspace-card">
                            <h3>Access your campaigns</h3>
                            <p>View and manage all your posts in your new Planable workspace:</p>
                            <a id="workspace-link" href="#" target="_blank" class="workspace-button">
                                Open Planable workspace
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/>
                                    <polyline points="15,3 21,3 21,9"/>
                                    <line x1="10" y1="14" x2="21" y2="3"/>
                                </svg>
                            </a>
                        </div>

                        <div class="next-steps">
                            <h3>Next steps</h3>
                            <ol>
                                <li>Access your Planable workspace</li>
                                <li>Review and customize your posts</li>
                                <li>Approve and publish your campaigns</li>
                                <li>Monitor your results</li>
                            </ol>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button onclick="location.reload()" class="btn btn-secondary">
                            Create new campaign
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>